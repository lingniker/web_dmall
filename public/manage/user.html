<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="myadmin/assets/css/bootstrap.css" rel="stylesheet" />
    <link href="myadmin/assets/css/font-awesome.css" rel="stylesheet" />
    <link href="myadmin/assets/js/morris/morris-0.4.3.min.css" rel="stylesheet" />
    <link href="myadmin/assets/css/custom-styles.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet" >
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link href="myadmin/css/common.css" rel="stylesheet">
    <!-- <link href='http://fonts.useso.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /> -->
    <title>Document</title>
</head>
<style>
    .data-title{
        height: 44px;
        margin-bottom: 20px;
        background: #fff;
    }
    .data-title p{
        padding:12px 0 0 12px;
    }
    .data-body{
        width: 100px;
        overflow: auto;
    }
    .body-left-ul li:hover{
        background: #575757;
        color: #F36A5A;
    }
    .body-data-box{
        height: 120px;
        width: 100%;
        padding-right: 10px;
        background: white;
    }
    .row-box{
        padding:15px;
    }
    .body-data-num{
        padding: 0px;
    }
    .body-data-name{
        padding: 0px 0px 0px 20px;
        font-size: 16px;
        color: #AAB5BC;
        font-weight: 600;
        text-transform: uppercase;
    }
    .body-data-num{
        padding: 30px 0px 0px 20px;
        font-size: 32px;
        font-weight: 600;
        color: #676767;
    }
    .user-manage li{
        height: 40px;
        line-height: 40px;
        padding: 5px 0px;
        margin: 20px 0px;
    }
    .user-manage li input{
        width: 450px;
        margin-right: 20px;
        padding-left: 10px;
    }
    .add-user {
        height: 24px;
        position: relative;
        overflow: hidden;
        margin-top:40px;
        /* overflow:visible; */
    }
    #add-user-btn{
        display: inline-block;
        padding: 0 10px;
        width: 35px;
        height: 24px;
        margin-left: 20px;
    }
    .input-user{
        width: 450px;
        height: 30px;
        position: absolute;
        top: 30px;
    }
    .input-user input{
        width: 400px;
        height: 35px;
        padding-left: 10px;
    }
    .user-manage button{
        padding: 0px 10px;
        margin: 0px 2px;
    }
    .input-user button{
        height: 34px;
        margin: 0 2px;
        padding: 0 5px;
    }

    .page-ul li{
        float: left;
        /* width: 24px; */
        height: 24px;
        padding: 0px 6px;
        border: 1px solid gray;
        text-align: center;
        cursor: pointer;
    }
    .page-ul li:hover{
        background: #fff;
    }
    .mymodal{
        margin-top:50px;
    }
</style>
<body>
<div class="admin-container">
    <div class="admin-nav">
        <div class="admin-nav-left">联家管理系统</div>
        <div class="admin-nav-right">
            <div class="back-login"><a href="#">退出登录</a></div>
        </div>
    </div>
    <div class="body">
        <div class="body-left">
            <ul class="body-left-ul">
                <li><a href="./index.html">首页</a></li>
                <li><a href="./control.html">控制面板</a></li>
                <li><a href="./store.html">店铺管理</a></li>
                <li ><a href="./commodity.html">商品管理</a></li>
                <li><a href="./order.html">订单详情</a></li>
                <li class="active"><a href="./user.html">用户管理</a></li>
                <li><a href="./address.html">地址管理</a></li>
                <li><a href="./advertising.html">广告公告</a></li>
                <li><a href="./classification.html">商品分类</a></li>
                <li><a href="./store_manage.html">店长管理</a></li>
                <li><a href="./courier.html">店员管理</a></li>
                <li><a href="./integral.html">积分管理</a></li>
                <li><a href="./coupon.html">优惠券管理</a></li>
            </ul>
        </div>
        <div class="body-right">
            <div class="body-right-title">用户管理</div>
            <div class="body-right-data">
                <div class="add-advertising" style="padding-bottom:30px;">

                </div>
                <ul class="commodity-manage">
                    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne1">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        维生素红牛功能饮料250毫升
                                    </a>
                                    <button type="button" class="btn btn-primary admin-btn" data-toggle="modal" data-target="#exampleModal" data-whatever="修改商品"
                                            data-list="name_商品名称:^:红牛维生素供能饮料225ml0&%_%&cost_成本价:^:50&%_%&price_零售价:^:60&%_%&introduction_商品简介:^:红牛维生素供能饮料0&%_%&weight_重量:^:0.50&%_%&categoryId_商品分类ID:^:27&%_%&hot_热度:^:10&%_%&remarks_备注:^:-0&%_%&imagePath_图片:^:|*-*|9">修改商品</button>
                                    <button type="button" class="btn btn-primary admin-btn" data-toggle="modal" data-target="#exampleModal" data-whatever="删除商品"
                                            data-list="name_商品名称:^:红牛维生素供能饮料225ml0">删除商品</button>
                                </h4>

                            </div>
                            <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                <div class="panel-body">
                                    <ul class="list-group">
                                        <li class="list-group-item">
                                            <span>描述:</span>
                                            <span class="store-num">维生素红牛功能饮料250毫升</span>
                                            <button>修改</button>
                                        </li>
                                        <li class="list-group-item">
                                            <span>上传人:</span>
                                            <span>张三 </span>
                                            <button>修改</button>
                                        </li>
                                        <li class="list-group-item">
                                            <span>售价：</span>
                                            <span>20元</span>
                                            <button>修改</button>
                                        </li>
                                        <li class="list-group-item">
                                            <span>分类：</span>
                                            <span>饮料</span>
                                            <button>修改</button>
                                        </li>
                                        <li class="list-group-item">
                                            <span class="">图片路径</span>
                                            <span class="">http://www.lianjianshangwu.com/images/1.png</span>
                                            <button>修改</button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>



                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingTwo">
                                <h4 class="panel-title store-panel">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                                        优质大米
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                <div class="panel-body">
                                    <ul class="list-group">
                                        <li class="list-group-item">
                                            <span>描述:</span>
                                            <span class="store-num"> 各种好品 全场9折 可享折上折</span>
                                            <button>修改</button>
                                        </li>
                                        <li class="list-group-item">
                                            <span>上传人:</span>
                                            <span>张四 </span>
                                            <button>修改</button>
                                        </li>
                                        <li class="list-group-item">
                                            <span>截至时间：</span>
                                            <span>2018.12.31/00：00：00</span>
                                            <button>修改</button>
                                        </li>
                                        <li class="list-group-item">
                                            <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
                                                店铺商品
                                            </a>
                                            <button class="">增加商品</button>
                                            <div id="collapseSix" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingSix">
                                                <div class="panel-body">
                                                    <ul class="list-group">
                                                        <li class="list-group-item">
                                                            <span>西红柿： </span>
                                                            <span class="store-num">库存：50斤</span>
                                                            <span class="float right"></span>
                                                            <span class="right">售价：5元/斤</span>
                                                        </li>
                                                        <li class="list-group-item">
                                                            <span>红牛维生素功能饮料250毫升  </span>
                                                            <span class="store-num"> 库存：200瓶</span>
                                                            <span class="float right"> </span>
                                                            <span class="right">售价：6元每瓶</span>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="list-group-item">
                                            <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
                                                店铺店员
                                            </a>
                                            <button class="">增加店员</button>
                                            <div id="collapseSeven" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingSeven">
                                                <div class="panel-body">
                                                    <ul class="list-group">
                                                        <li class="list-group-item">
                                                            <span>王六： </span>
                                                            <span class="store-num">年龄：25岁</span>
                                                            <span class="float right">职位：配送员</span>
                                                            <span class="right">电话：1888888888888</span>
                                                            <button>修改</button>
                                                        </li>
                                                        <li class="list-group-item">
                                                            <span>李六： </span>
                                                            <span class="store-num">年龄：25岁</span>
                                                            <span class="float right">职位：收银员</span>
                                                            <span class="right">电话：1888888888888</span>
                                                            <button>修改</button>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="page" style="padding-top:10px;">
                            <ul class="page-ul">
                            </ul>
                            <div><input type="text" style="margin:0 5px 0px 20px;width:30px;"><button>跳转</button></div>
                        </div>
                    </div>
                </ul>
            </div>
        </div>
        <div class="floor"></div>

        <div class="modal fade mymodal" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">消息</h4>
                    </div>
                    <div class="modal-body append-form">

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                        <button type="button" class="btn btn-primary" id="modal-commit">提交</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="myadmin/assets/js/jquery-1.10.2.js"></script>
<!-- Bootstrap Js -->
<script src="myadmin/assets/js/bootstrap.min.js"></script>
<!-- Metis Menu Js -->
<script src="myadmin/assets/js/jquery.metisMenu.js"></script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script type="text/javascript" src="myadmin/js/config.js"></script>
<script>
    var $_331 = jQuery.noConflict();
    console.log(url);
    var pageNum = 1;
    var pageSize = 1;
    (function(){
        //动态生成page页
        $('.page ul').append("<li><</li>");
        for(var i = 0; i<5;i++){
            $('.page ul').append("<li>"+i+"</li>");
        };
        $('.page ul').append("<li>></li>");
        $("#headingOne1").on("click",function(){
            $('#collapseOne').collapse('toggle');
        });
        $('.collapse').collapse();
        function findAllUser(pageNum){
            var obj = {};
            obj.pageNum = pageNum;
            obj.pageSize = pageSize;
            obj.access_token = sessionStorage.access_token;
            obj.timestamp = parseInt(new Date().getTime()/1000);
            obj.form = "web";

            var newobj = srotKeyObj(obj);
            var str = objmd5(newobj);

            var newUrl = url + "user/customerList?" + str ;
            console.log(newUrl);


            $.ajax({
                url:newUrl,
                type:"get",
                dataType:"json",
                success:function(data){
                    console.log("ok");
                    console.log(data);
                    //添加长list
                    var listNode = '';
                    for(var i = 0; i < data.data.list.length;i++){
                        listNode += '<div class="panel panel-default"><div class="panel-heading" role="tab" id="heading'+data.data.list[i].id+'">'
                            + '<h4 class="panel-title">'
                            +  '<a role="button" data-toggle="collapse" style="min-width:400px;display: inline-block;" data-parent="#accordion" href="#collapse'+data.data.list[i].id+'" style="min-width:200px;" aria-expanded="true" aria-controls="collapse'+data.data.list[i].id+'">'
                            + data.data.list[i].nickname
                            + '</a>'
                            + '</h4></div>'
                            + '<div id="collapse'+data.data.list[i].id+'" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">'
                            + '<div class="panel-body">'
                            + '<div class="panel-body">'
                            + '<li class="list-group-item">'
                            + '<span>昵称:</span>'
                            + '<span class="store-num">'+data.data.list[i].nickname+'</span>'
                            + '</li>'
                            + '<li class="list-group-item">'
                            + '<span>手机号:</span>'
                            + '<span class="store-num">'+data.data.list[i].phone+'</span>'
                            + '</li>'

                            + '<li class="list-group-item">'
                            + '<span>余额:</span>'
                            + '<span class="store-num">'+data.data.list[i].balance+'</span>'
                            + '</li>'
                            + '<li class="list-group-item">'
                            + '<span>积分:</span>'
                            + '<span class="store-num">'+data.data.list[i].score+'</span>'
                            + '</li>'
                            + '<li class="list-group-item">'
                            + '<span>创建时间:</span>'
                            + '<span class="store-num">'+data.data.list[i].createTime+'</span>'
                            + '</li>'
                            + '<li class="list-group-item">'
                            + '<span>更新时间:</span>'
                            + '<span class="store-num">'+data.data.list[i].updateTime+'</span>'
                            + '</li>'
                            + '<li class="list-group-item">'
                            + '<span>头像路径:</span>'
                            + '<span class="store-num">'+data.data.list[i].headimgurl+'</span>'
                            + '</li>'

                            + '</ul></div></div></div></div>'
                    }

                    listNode += '<div class="page" style="padding-top:10px;"><ul class="page-ul"></ul><div><input type="text" class="inputPage" style="margin:0 5px 0px 20px;width:30px;text-align:center;"><button class="btnPage">跳转</button>   &nbsp;&nbsp;&nbsp;共&nbsp;<span class="sumPage">'+data.data.pages+'</span>&nbsp;页</div></div>';

                    $('.panel-group').html(listNode);
                    $('.collapse').collapse();

                    $('.page ul').append("<li data-id='"+data.data.prePage+"'><</li>");

                    if(data.data.pages > 5){
                        if(data.data.pageNum < 3){
                            for(var i = 1 ; i < 4 ; i++){
                                if(data.data.pageNum == i){
                                    $('.page ul').append("<li data-id="+i+">"+i+"</li>").find("li").eq(i).css({"color":"red"});
                                }else{
                                    $('.page ul').append("<li data-id="+i+">"+i+"</li>");
                                }
                            }
                            $('.page ul').append("<li data-id="+"..."+">"+"..."+"</li>");
                            $('.page ul').append("<li data-id="+data.data.pages+">"+data.data.pages+"</li>");
                        }else if(data.data.pageNum == 3){
                            $('.page ul').append("<li data-id="+1+">"+1+"</li>");
                            $('.page ul').append("<li data-id="+2+">"+2+"</li>");
                            $('.page ul').append("<li data-id="+3+">"+3+"</li>").find("li").eq(3).css({"color":"red"});
                            $('.page ul').append("<li data-id="+4+">"+4+"</li>");
                            $('.page ul').append("<li data-id="+"..."+">"+"..."+"</li>");
                            $('.page ul').append("<li data-id="+data.data.pages+">"+data.data.pages+"</li>");
                        }else if(data.data.pageNum-3 > 0){
                            $('.page ul').append("<li data-id="+1+">"+1+"</li>");
                            $('.page ul').append("<li data-id="+"..."+">"+"..."+"</li>");
                            if(data.data.pages-data.data.pageNum >= 3){
                                $('.page ul').append("<li data-id="+data.data.prePage+">"+data.data.prePage+"</li>");
                                $('.page ul').append("<li data-id="+data.data.pageNum+" style='color:red'>"+data.data.pageNum+"</li>");
                                $('.page ul').append("<li data-id="+data.data.nextPage+">"+data.data.nextPage+"</li>");
                                $('.page ul').append("<li data-id="+"..."+">"+"..."+"</li>");
                                $('.page ul').append("<li data-id="+data.data.pages+">"+data.data.pages+"</li>");
                            }else if(data.data.pages-data.data.pageNum == 2){
                                $('.page ul').append("<li data-id="+data.data.prePage+">"+data.data.prePage+"</li>");
                                $('.page ul').append("<li data-id="+data.data.pageNum+" style='color:red'>"+data.data.pageNum+"</li>");
                                $('.page ul').append("<li data-id="+data.data.nextPage+">"+data.data.nextPage+"</li>");
                                $('.page ul').append("<li data-id="+data.data.pages+">"+data.data.pages+"</li>");
                            }else if(data.data.pages-data.data.pageNum == 1){
                                $('.page ul').append("<li data-id="+data.data.prePage+">"+data.data.prePage+"</li>");
                                $('.page ul').append("<li data-id="+data.data.pageNum+" style='color:red'>"+data.data.pageNum+"</li>");
                                $('.page ul').append("<li data-id="+data.data.pages+">"+data.data.pages+"</li>");
                            }else if(data.data.pages-data.data.pageNum == 0){
                                $('.page ul').append("<li data-id="+data.data.prePage+">"+data.data.prePage+"</li>");
                                $('.page ul').append("<li data-id="+data.data.pages+" style='color:red'>"+data.data.pages+"</li>");
                            }
                        }
                    }else{
                        for(let i = 0; i<data.data.pages;i++){
                            var k = i + 1;
                            if(k == data.data.pageNum){
                                $('.page ul').append("<li data-id="+k+">"+k+"</li>").find("li").eq(k).css({"color":"red"});
                            }else{
                                $('.page ul').append("<li data-id="+k+">"+k+"</li>");
                            }
                        };
                    }
                    $('.page ul').append("<li data-id='"+data.data.nextPage+"'>></li>");


                },
                error:function(err){
                    console.log("err");
                    console.log(err);
                }
            });

        }
        findAllUser(pageNum);

        //选择分页
        $(document).on("click",".page-ul li",function(evev){
            console.log($(this).data("id"));
            if($(this).data("id")=="..."||$(this).data("id")=="0"){
            }else{
                findAllUser($(this).data("id"));
            }
        });

        //跳转
        $(document).on("click",".btnPage",function(evev){
            // alert($(".inputPage").val());
            // alert($(".sumPage").text());
            console.log($(this).data("id"));
            if(/^[1-9]\d*$/.test($(".inputPage").val())){
                // alert($(".inputPage").val());
                var bottom_num=parseInt($(".inputPage").val());
                var sumpage=parseInt($(".sumPage").text());
                if($(".inputPage").val()==""||bottom_num>sumpage){
                    alert("大于总页数不能跳转!");
                }else {
                    // alert("跳转成功到第"+bottom_num+"页!");
                    console.log(bottom_num);
                    findAllUser(bottom_num);
                }

            }else {
                alert("只能输入正整数!");
            }
        });


    })();
</script>
</body>
</html>